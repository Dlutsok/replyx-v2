# –°–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã—Ö –ø—Ä–æ–∫—Å–∏ ChatAI

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2025-09-07  
**–ê–≤—Ç–æ—Ä:** –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è Claude Code

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã—Ö –ø—Ä–æ–∫—Å–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ OpenAI API —á–µ—Ä–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ HTTP/SOCKS –ø—Ä–æ–∫—Å–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –ø—Ä–∏ —Å–±–æ—è—Ö.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–µ–π–ª–æ–≤–µ—Ä** (–Ω–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏)
- ‚úÖ **Circuit Breaker —Å half-open —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º** 
- ‚úÖ **–£–º–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫**
- ‚úÖ **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å POST –∑–∞–ø—Ä–æ—Å–æ–≤**
- ‚úÖ **Comprehensive –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏**
- ‚úÖ **Chaos testing –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏**

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
graph TB
    subgraph "Application Layer"
        AI[AI Provider]
        PM[Proxy Manager]
        CB[Circuit Breaker]
    end
    
    subgraph "Proxy Pool"
        P1[Primary Proxy<br/>Priority 1]
        P2[Secondary Proxy<br/>Priority 2] 
        P3[Tertiary Proxy<br/>Priority 3]
    end
    
    subgraph "Monitoring"
        M[Metrics API]
        H[Health Checks]
        A[Alerts]
    end
    
    AI --> PM
    PM --> CB
    CB --> P1
    CB --> P2
    CB --> P3
    
    PM --> M
    M --> H
    M --> A
    
    classDef proxy fill:#e1f5fe
    classDef monitor fill:#f3e5f5
    class P1,P2,P3 proxy
    class M,H,A monitor
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Å–∏ –≤ .env

```bash
# –ù–æ–≤—ã–π JSON —Ñ–æ—Ä–º–∞—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)
OPENAI_PROXY_CONFIG='[
  {
    "url": "http://username:password@proxy1.example.com:8080",
    "priority": 1,
    "name": "primary"
  },
  {
    "url": "socks5://username:password@proxy2.example.com:1080", 
    "priority": 2,
    "name": "secondary"
  },
  {
    "url": "http://username:password@proxy3.example.com:3128",
    "priority": 3,
    "name": "tertiary"
  }
]'

# –¢–∞–π–º–∏–Ω–≥–∏
OPENAI_PROXY_CONNECT_TIMEOUT=5    # –ë—ã—Å—Ç—Ä–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
OPENAI_PROXY_READ_TIMEOUT=30      # –û–±—ã—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
OPENAI_PROXY_STREAM_TIMEOUT=300   # WebSocket/—Å—Ç—Ä–∏–º—ã

# Backward compatibility
OPENAI_PROXY_URL=http://username:password@legacy-proxy.com:8080
```

### 2. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã

- **HTTP/HTTPS –ø—Ä–æ–∫—Å–∏**: `http://user:pass@host:port`
- **SOCKS5 –ø—Ä–æ–∫—Å–∏**: `socks5://user:pass@host:port`
- **–ë–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**: `http://host:port`

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –í—ã–±–æ—Ä –ø—Ä–æ–∫—Å–∏

```python
def get_available_proxy():
    # 1. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ priority (–º–µ–Ω—å—à–µ = –≤—ã—à–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)  
    sorted_proxies = sorted(proxies, key=lambda x: x.priority)
    
    # 2. –ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø—Ä–æ–∫—Å–∏ (circuit breaker CLOSED/HALF_OPEN)
    for proxy in sorted_proxies:
        if circuit_breaker.can_make_request(proxy):
            return proxy
    
    return None  # –í—Å–µ –ø—Ä–æ–∫—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
```

### 2. Circuit Breaker —Å–æ—Å—Ç–æ—è–Ω–∏—è

| –°–æ—Å—Ç–æ—è–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–µ—Ä–µ—Ö–æ–¥—ã |
|-----------|----------|----------|
| **CLOSED** | –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ | ‚Üí OPEN (–ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö) |
| **OPEN** | –ü—Ä–æ–∫—Å–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω | ‚Üí HALF_OPEN (–ø–æ—Å–ª–µ cooldown) |
| **HALF_OPEN** | –ü—Ä–æ–±–Ω–∞—è –∑–∞—è–≤–∫–∞ | ‚Üí CLOSED (—É—Å–ø–µ—Ö) –∏–ª–∏ ‚Üí OPEN (–æ—à–∏–±–∫–∞) |

### 3. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫

```python
class ProxyErrorClassifier:
    # –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–∫—Å–∏
    IMMEDIATE_SWITCH = [
        ConnectError,      # –ü—Ä–æ–∫—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
        ConnectTimeout,    # –¢–∞–π–º–∞—É—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è  
        ProxyError,        # –û—à–∏–±–∫–∞ –ø—Ä–æ–∫—Å–∏-–ø—Ä–æ—Ç–æ–∫–æ–ª–∞
    ]
    
    # 1 retry, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ  
    RETRY_THEN_SWITCH = [
        ReadTimeout        # –í–æ–∑–º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞
    ]
    
    # –î–ª–∏—Ç–µ–ª—å–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (15 –º–∏–Ω)
    LONG_COOLDOWN_CODES = [407, 403, 429]
    
    # –ù–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –ø—Ä–æ–∫—Å–∏ (–ø—Ä–æ–±–ª–µ–º–∞ —Å OpenAI API)
    UPSTREAM_ERROR_CODES = [500, 502, 503, 504]
```

### 4. –í—Ä–µ–º–µ–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (cooldown)

| –¢–∏–ø –æ—à–∏–±–∫–∏ | Cooldown | –ü—Ä–∏—á–∏–Ω–∞ |
|------------|----------|---------|
| `ConnectError` | 60s | –ü—Ä–æ–∫—Å–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω |
| `ReadTimeout` | 30s | –í–æ–∑–º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ |  
| `HTTP 407/403` | 15min | –ü—Ä–æ–±–ª–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| `HTTP 429` | 5min | Rate limiting |
| `HTTP 5xx` | 0s | –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º (–ø—Ä–æ–±–ª–µ–º–∞ upstream) |

## –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

### POST –∑–∞–ø—Ä–æ—Å—ã —Å Idempotency-Key

```python
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
idempotency_key = str(uuid.uuid4())
headers["Idempotency-Key"] = idempotency_key

# OpenAI –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–ª—è:
# - /chat/completions
# - /embeddings
# - /moderations
```

–≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ retry/–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–æ–∫—Å–∏.

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### 1. API Endpoints

```bash
# Health check (–ø—É–±–ª–∏—á–Ω—ã–π)
GET /api/proxy/health
Response: {
  "status": "healthy|degraded|unhealthy",
  "available_proxies": 2,
  "total_proxies": 3
}

# –ü–æ–ª–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–∞–¥–º–∏–Ω)
GET /api/proxy/metrics  
Response: {
  "total_proxies": 3,
  "available_proxies": 2, 
  "proxies": [
    {
      "name": "primary",
      "circuit_state": "closed",
      "requests_total": 1250,
      "requests_ok": 1200,
      "success_rate": 96.0,
      "p95_response_time": 1.2,
      "last_error_type": null
    }
  ]
}

# –ê–ª–µ—Ä—Ç—ã
GET /api/proxy/alerts
Response: {
  "alerts": [
    {
      "severity": "warning",
      "title": "–ü—Ä–æ–∫—Å–∏ 'secondary' –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",
      "description": "Circuit breaker –æ—Ç–∫—Ä—ã—Ç. –ü–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: connection_error"
    }
  ]
}

# Prometheus –º–µ—Ç—Ä–∏–∫–∏
GET /api/proxy/metrics/prometheus
Response: 
proxy_total_count 3
proxy_available_count 2
proxy_requests_total{proxy_name="primary"} 1250
proxy_success_rate{proxy_name="primary"} 96.0
```

### 2. –ê–ª–µ—Ä—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞):**
- üö® **–í—Å–µ –ø—Ä–æ–∫—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã** > 30 —Å–µ–∫—É–Ω–¥
- üö® **Success rate < 80%** –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –º–∏–Ω—É—Ç

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (—Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è):**
- ‚ö†Ô∏è **–ü—Ä–æ–∫—Å–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω** (circuit breaker OPEN)  
- ‚ö†Ô∏è **Success rate < 95%** –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –º–∏–Ω—É—Ç
- ‚ö†Ô∏è **–í—ã—Å–æ–∫–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞** (P95 > 5 —Å–µ–∫—É–Ω–¥)
- ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** (N –∏–∑ M –ø—Ä–æ–∫—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã)

## Chaos Testing

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞
export API_TOKEN=your-admin-token
./scripts/proxy_chaos_test.sh --duration 60

# –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ—Å—Ç:
# 1. –ë–ª–æ–∫–∏—Ä—É–µ—Ç primary –ø—Ä–æ–∫—Å–∏ —á–µ—Ä–µ–∑ iptables
# 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã  
# 3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –ø—Ä–æ–∫—Å–∏
# 4. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç success rate –∏ response time
# 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞
```

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–£—Å–ø–µ—à–Ω—ã–π —Ç–µ—Å—Ç:**
- ‚úÖ Success rate > 95% –≤–æ –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ secondary < 5 —Å–µ–∫—É–Ω–¥
- ‚úÖ P95 response time < 3x –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ primary

**–ü—Ä–æ–±–ª–µ–º—ã (—Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):**
- ‚ùå Success rate < 80%
- ‚ùå –î–ª–∏—Ç–µ–ª—å–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å > 10 —Å–µ–∫—É–Ω–¥  
- ‚ùå –ü—Ä–æ–∫—Å–∏ –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**1. –í—Å–µ –ø—Ä–æ–∫—Å–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç OPEN**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å connectivity
curl -x http://proxy1.com:8080 https://api.openai.com/v1/models

# –°–±—Ä–æ—Å–∏—Ç—å circuit breaker (–∞–¥–º–∏–Ω)
curl -X POST /api/proxy/proxies/primary/reset \
  -H "Authorization: Bearer $ADMIN_TOKEN"
```

**2. –í—ã—Å–æ–∫–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å P95 –≤—Ä–µ–º–µ–Ω–∞ –æ—Ç–≤–µ—Ç–∞
curl /api/proxy/metrics | jq '.proxies[].p95_response_time'

# –ù–∞–π—Ç–∏ –º–µ–¥–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–∫—Å–∏
curl /api/proxy/metrics | jq '.proxies[] | select(.p95_response_time > 3.0)'
```

**3. –ß–∞—Å—Ç—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–∫—Å–∏**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã –æ—à–∏–±–æ–∫
curl /api/proxy/metrics | jq '.proxies[] | {name, last_error_type}'

# –ï—Å–ª–∏ ReadTimeout - —É–≤–µ–ª–∏—á–∏—Ç—å timeout
OPENAI_PROXY_READ_TIMEOUT=60  # –≤–º–µ—Å—Ç–æ 30
```

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

```bash
# Backend –ª–æ–≥–∏
tail -f backend/logs/api.log | grep -i proxy

# –ö–ª—é—á–µ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
# "üîó –ü–æ–ø—ã—Ç–∫–∞ 1/3 —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏: ***@proxy1.com:8080"
# "‚úÖ –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ 'primary' –∑–∞ 1.23s"  
# "‚ö†Ô∏è –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–æ–∫—Å–∏ (–ø–æ–ø—ã—Ç–∫–∞ 2): ConnectError"
# "‚õî –ü—Ä–æ–∫—Å–∏ 'primary' –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ 60s –ø–æ—Å–ª–µ 3 –æ—à–∏–±–æ–∫ —Ç–∏–ø–∞ connection_error"
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

**–î–ª—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏:**
```bash
# –ë—ã—Å—Ç—Ä—ã–µ —Ç–∞–π–º–∏–Ω–≥–∏
OPENAI_PROXY_CONNECT_TIMEOUT=3
OPENAI_PROXY_READ_TIMEOUT=15

# –ë–æ–ª—å—à–µ –ø—Ä–æ–∫—Å–∏ –≤ –ø—É–ª–µ (3-5 —à—Ç—É–∫)
OPENAI_PROXY_CONFIG='[...5 proxies...]'
```

**–î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏:**
```bash
# –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–µ —Ç–∞–π–º–∏–Ω–≥–∏  
OPENAI_PROXY_CONNECT_TIMEOUT=10
OPENAI_PROXY_READ_TIMEOUT=60

# –ú–µ–Ω—å—à–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π
# (—É–≤–µ–ª–∏—á–∏—Ç—å failure_threshold –≤ –∫–æ–¥–µ)
```

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **Overhead –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è**: ~0.1-0.5s –Ω–∞ retry
- **Memory usage**: ~1KB –Ω–∞ –ø—Ä–æ–∫—Å–∏ (–º–µ—Ç—Ä–∏–∫–∏)  
- **CPU overhead**: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (async/await)
- **Network connections**: 1 –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

## Roadmap

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

**Phase 2 (–±—É–¥—É—â–µ–µ):**
- [ ] **–ê–∫—Ç–∏–≤–Ω–æ-–∞–∫—Ç–∏–≤–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞** (–ø–æ—Å–ª–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫)
- [ ] **Weighted round-robin** –ø–æ response time
- [ ] **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è** (–±–ª–∏–∂–∞–π—à–∏–π –ø—Ä–æ–∫—Å–∏)
- [ ] **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—É–ª–∞ –ø—Ä–æ–∫—Å–∏
- [ ] **ML-based prediction** –¥–ª—è –ø—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

**Phase 3 (advanced):**
- [ ] **Dynamic proxy discovery** –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤  
- [ ] **Cost optimization** –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- [ ] **Regional failover** (US ‚Üí EU ‚Üí Asia)
- [ ] **Request replay** –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã—Ö –ø—Ä–æ–∫—Å–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- **99.9%+ uptime** –¥–ª—è OpenAI API –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
- **–î–µ—Ç–∞–ª—å–Ω—É—é observability** –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã  
- **–ü—Ä–æ—Å—Ç–æ—Ç—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** —á–µ—Ä–µ–∑ JSON –≤ .env
- **Backward compatibility** —Å–æ —Å—Ç–∞—Ä—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ chaos testing'–æ–º –∏ –≥–æ—Ç–æ–≤–∞ –¥–ª—è production –Ω–∞–≥—Ä—É–∑–∫–∏.