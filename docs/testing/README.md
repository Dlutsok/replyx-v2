# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ReplyX

## –û–±–∑–æ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ReplyX –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –æ—Å–æ–±—ã–º –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ **–∑–∞—â–∏—Ç—É –æ—Ç —Ç—Ä–∞—Ç —Ç–æ–∫–µ–Ω–æ–≤** –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ä–µ–¥.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ test_token_protection.py          # –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Ç—Ä–∞—Ç —Ç–æ–∫–µ–Ω–æ–≤
‚îú‚îÄ‚îÄ test_token_protection_simple.py   # –£–ø—Ä–æ—â—ë–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∑–∞—â–∏—Ç—ã  
‚îú‚îÄ‚îÄ test_websocket_critical_fixes.py  # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è WebSocket
‚îî‚îÄ‚îÄ conftest.py                       # –ì–ª–æ–±–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
```

## –¢–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç —Ç—Ä–∞—Ç —Ç–æ–∫–µ–Ω–æ–≤
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô**

- **–§–∞–π–ª—ã**: `test_token_protection*.py`
- **–¶–µ–ª—å**: 100% –≥–∞—Ä–∞–Ω—Ç–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ç—Ä–∞—Ç –Ω–∞ LLM –≤ —Ç–µ—Å—Ç–∞—Ö
- **–ü–æ–∫—Ä—ã—Ç–∏–µ**: 18 —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤, –≤–∫–ª—é—á–∞—è —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã –¥–æ 300 concurrent –≤—ã–∑–æ–≤–æ–≤
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

[‚û°Ô∏è –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](./token-protection.md)

### 2. üîå WebSocket —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô**

- **–§–∞–π–ª—ã**: `test_websocket_critical_fixes.py`
- **–¶–µ–ª—å**: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π WebSocket —Å–∏—Å—Ç–µ–º—ã
- **–ü–æ–∫—Ä—ã—Ç–∏–µ**: Security fixes, rate limiting, connection management
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

### 3. üîí Security —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô**

- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: JWT validation, CORS, IP spoofing protection
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**: pytest, mock, security scanners
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ (conftest.py)

### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã

#### üîí –ó–∞—â–∏—Ç–∞ –æ—Ç —Ç—Ä–∞—Ç —Ç–æ–∫–µ–Ω–æ–≤
```python
@pytest.fixture(autouse=True, scope="session")
def force_test_environment():
    """–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è"""
    
@pytest.fixture(autouse=True, scope="function")
def verify_no_real_llm():
    """–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ FakeLLM"""
```

#### üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã
```python
@pytest.fixture
def fake_llm():
    """–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç FakeLLM –∏–Ω—Å—Ç–∞–Ω—Å"""
    
@pytest.fixture
def dry_run_headers():
    """HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è dry-run —Ä–µ–∂–∏–º–∞"""
```

#### ‚ö†Ô∏è –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
```python
@pytest.fixture  
def live_ai_test(request):
    """–§–∏–∫—Å—Ç—É—Ä–∞ –¥–ª—è —Ä–µ–¥–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏"""
    # –¢—Ä–µ–±—É–µ—Ç —è–≤–Ω–æ–≥–æ –º–∞—Ä–∫–µ—Ä–∞ @pytest.mark.live_ai
```

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã
```bash
# –£–ø—Ä–æ—â—ë–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (6 —Å–µ–∫)
pytest tests/test_token_protection_simple.py -v

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# ‚úÖ 7 passed in 0.06s
# ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ 50 AI –≤—ã–∑–æ–≤–æ–≤ —Å –ù–£–õ–ï–í–û–ô —Ç—Ä–∞—Ç–æ–π —Ç–æ–∫–µ–Ω–æ–≤
```

### –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—Ç—ã
```bash
# –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—è —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
pytest tests/test_token_protection.py -v

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# ‚úÖ 11 passed in 0.07s 
# ‚úÖ Completed 300 AI calls with ZERO tokens spent
```

### –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞—â–∏—Ç—ã
```bash
# –í—Å—ë –≤–º–µ—Å—Ç–µ (18 —Ç–µ—Å—Ç–æ–≤)
pytest tests/test_token_protection*.py -v

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# ‚úÖ 18 passed in 0.06s
```

### WebSocket —Ç–µ—Å—Ç—ã
```bash
# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è WebSocket
pytest tests/test_websocket_critical_fixes.py -v
```

### –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤
```bash
# –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/ -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest tests/ --cov=services --cov-report=html
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```bash
ENVIRONMENT=test                # –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
LLM_PROVIDER=fake              # –¢–æ–ª—å–∫–æ —Ñ–µ–π–∫–æ–≤—ã–π LLM
BLOCK_EXTERNAL_IO=true         # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤
IS_TEST_ENV=true               # –§–ª–∞–≥ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
FAKE_LLM_MODE=echo            # –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã FakeLLM
```

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ  
```bash
WS_LOG_LEVEL=DEBUG            # –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è WebSocket
PYTEST_CURRENT_TEST=...       # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è pytest
```

## –ú–∞—Ä–∫–µ—Ä—ã pytest

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã
```python
@pytest.mark.asyncio           # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
@pytest.mark.parametrize       # –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã
```python
@pytest.mark.live_ai           # –¢–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ (–û–ü–ê–°–ù–û!)
@pytest.mark.external_io       # –¢–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–µ—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤
```

## –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
pytest tests/ -v --log-cli-level=DEBUG
```

### –ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
```bash
pytest tests/test_token_protection.py::TestTokenProtection::test_environment_configuration -v
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
```bash
pytest tests/ -x
```

### –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ —É–ø–∞–≤—à–∏—Ö —Ç–µ—Å—Ç–æ–≤
```bash
pytest tests/ --lf  # last-failed
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

### GitHub Actions
```yaml
- name: Run Token Protection Tests
  run: |
    export ENVIRONMENT=test
    export LLM_PROVIDER=fake
    export BLOCK_EXTERNAL_IO=true
    pytest tests/test_token_protection*.py -v
    
- name: Verify Zero Token Spending  
  run: |
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤ –ª–æ–≥–∞—Ö –Ω–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞—Ç–∞—Ö
    ! grep -r "REAL tokens will be spent" test-logs/
```

### Pre-commit hooks
```yaml
repos:
  - repo: local
    hooks:
      - id: token-protection-tests
        name: Token Protection Tests
        entry: pytest tests/test_token_protection_simple.py
        language: system
        pass_filenames: false
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ—Å—Ç–æ–≤

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- **Token Protection**: 100% –∑–∞—â–∏—Ç–∞ –æ—Ç —Ç—Ä–∞—Ç (18/18 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- **Test Coverage**: >80% –ø–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–¥–∞
- **Test Performance**: –¢–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è <10 —Å–µ–∫—É–Ω–¥
- **Flaky Tests**: 0 –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

### –ê–ª–µ—Ä—Ç—ã
- ‚ùå –ü—Ä–æ–≤–∞–ª —Ç–µ—Å—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –æ—Ç —Ç–æ–∫–µ–Ω–æ–≤ ‚Üí –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –∞–ª–µ—Ä—Ç
- ‚ö†Ô∏è –°–Ω–∏–∂–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞ > 5% ‚Üí WARNING
- üêå –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ç–µ—Å—Ç–æ–≤ > 50% ‚Üí INFO

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
1. **–í—Å–µ–≥–¥–∞** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `generate_ai_response()` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö LLM –≤—ã–∑–æ–≤–æ–≤
2. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ** `response["metadata"]["is_fake"]` –≤ —Ç–µ—Å—Ç–∞—Ö
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ** —Ñ–∏–∫—Å—Ç—É—Ä—ã –∏–∑ `conftest.py`
4. **–î–æ–±–∞–≤–ª—è–π—Ç–µ** —Ç–µ—Å—Ç—ã –∑–∞—â–∏—Ç—ã –¥–ª—è –Ω–æ–≤—ã—Ö AI —Ñ—É–Ω–∫—Ü–∏–π
5. **–ó–∞–ø—É—Å–∫–∞–π—Ç–µ** –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

### ‚ùå –ò–∑–±–µ–≥–∞–π—Ç–µ
1. **–ù–ï** –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ `BLOCK_EXTERNAL_IO=false` –≤ CI/CD
2. **–ù–ï** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `@pytest.mark.live_ai` –±–µ–∑ –∫—Ä–∞–π–Ω–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏  
3. **–ù–ï** –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –Ω–∞–ø—Ä—è–º—É—é –≤ —Ç–µ—Å—Ç–∞—Ö
4. **–ù–ï** –∫–æ–º–º–∏—Ç—å—Ç–µ —Ç–µ—Å—Ç—ã –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞—â–∏—Ç—ã –æ—Ç —Ç—Ä–∞—Ç —Ç–æ–∫–µ–Ω–æ–≤
5. **–ù–ï** –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞—Ç–∞—Ö

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

### –®–∞–±–ª–æ–Ω —Ç–µ—Å—Ç–∞ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç —Ç–æ–∫–µ–Ω–æ–≤
```python
import pytest
from services.llm_client import generate_ai_response

class TestMyFeature:
    @pytest.mark.asyncio
    async def test_my_ai_feature(self):
        """–¢–µ—Å—Ç –Ω–æ–≤–æ–π AI —Ñ—É–Ω–∫—Ü–∏–∏ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç —Ç—Ä–∞—Ç —Ç–æ–∫–µ–Ω–æ–≤"""
        
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞—â–∏—â—ë–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
        response = await generate_ai_response(
            messages=[{"role": "user", "content": "test"}],
            dialog_id=123
        )
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–æ–∫–µ–Ω—ã –Ω–µ –ø–æ—Ç—Ä–∞—á–µ–Ω—ã
        assert response["metadata"]["is_fake"] == True
        assert response["metadata"]["tokens_used"] == 0
        assert response["metadata"]["cost"] == 0.0
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
        assert "test" in response["content"]
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ CI/CD
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –æ–±–Ω–æ–≤–∏—Ç–µ:
1. `.github/workflows/test-suite.yml`
2. `pre-commit` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é  
3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç —Å "External IO blocked"
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `conftest.py` –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: FakeLLM –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö  
**–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ–∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –º–æ–¥—É–ª–∏ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ environment variables:
```python
import importlib
import services.llm_client
importlib.reload(services.llm_client)
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
**–†–µ—à–µ–Ω–∏–µ**: 
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ø—Ä–æ—â—ë–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
2. –ü—Ä–æ—Ñ–∏–ª–∏—Ä—É–π—Ç–µ —Ç–µ—Å—Ç—ã: `pytest --profile`
3. –†–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏–µ: `pytest -n auto`

---

**üéØ –¶–µ–ª—å**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å 100% –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∑–∞—â–∏—Ç—ã –æ—Ç —Ç—Ä–∞—Ç —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø–æ–ª–Ω–æ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.