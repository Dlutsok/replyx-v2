# ReplyX Widget - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ SSE

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 6 —Å–µ–Ω—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–û  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ –∫:** SSE-based –≤–∏–¥–∂–µ—Ç—ã –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –æ—Ç WebSocket

---

## üö® –°–∏–º–ø—Ç–æ–º—ã –∏ –±—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### "–°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –≤–∏–¥–∂–µ—Ç–∞ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ –∞–¥–º–∏–Ω–∫–µ"

#### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL SSE –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ (Network tab)
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: localhost:8000/api/dialogs/1/events
# –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: localhost:3000/api/dialogs/1/events

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend
docker logs replyx-backend | grep -E "(WIDGET‚ÜíADMIN|SSE Manager)" --tail=20

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä—è–º–æ–µ SSE –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
curl -N "http://localhost:8000/api/dialogs/1/events?assistant_id=3&guest_id=test"
```

#### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞:
- **–ü—Ä–∏—á–∏–Ω–∞ 1:** –ê–¥–º–∏–Ω–∫–∞ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É (3000) –≤–º–µ—Å—Ç–æ –±—ç–∫–µ–Ω–¥–∞ (8000)
- **–ü—Ä–∏—á–∏–Ω–∞ 2:** –û–±—Ä–∞–±–æ—Ç—á–∏–∫ SSE –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–±—ã—Ç–∏–π
- **–ü—Ä–∏—á–∏–Ω–∞ 3:** –ö—ç—à –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **–ü—Ä–∏—á–∏–Ω–∞ 4:** –°–æ–±—ã—Ç–∏—è –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª

---

## üîç –ü–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ SSE –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

#### –í –±—Ä–∞—É–∑–µ—Ä–µ (DevTools ‚Üí Network):
```
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
GET http://localhost:8000/api/dialogs/1/events?token=...
Status: 200
Type: eventsource

‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
GET http://localhost:3000/api/dialogs/1/events?token=...
Status: 404 –∏–ª–∏ CORS error
```

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å URL:
```javascript
// –§–∞–π–ª: frontend/config/api.js
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ localhost –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ :8000
if (host.startsWith('localhost:') || host.startsWith('127.0.0.1:')) {
  return `${protocol}//localhost:8000`; // –±—ç–∫–µ–Ω–¥
}
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Å–æ–±—ã—Ç–∏–π SSE

#### –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
```javascript
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
üì® [–ê–î–ú–ò–ù SSE] –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {type: "message:new", message: {...}}
üì• [–ê–î–ú–ò–ù SSE] –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç user: —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
‚úÖ [–ê–î–ú–ò–ù SSE] –°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: 123

‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
üì® [–ê–î–ú–ò–ù SSE] –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ: {id: 123, sender: "user", text: "..."}
(–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ª–æ–≥–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è)
```

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π:
```javascript
// –§–∞–π–ª: frontend/components/dialogs/DialogModal.js
// –û–±–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
if (data.type === 'message:new' && data.message) {
  const message = data.message;
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
}
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π –≤ backend

#### –õ–æ–≥–∏ backend –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
```bash
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
üöÄ [WIDGET‚ÜíADMIN] –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç user –≤ –¥–∏–∞–ª–æ–≥–µ 1
‚úÖ [WIDGET‚ÜíADMIN] –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –≤ Redis: dialog_id=1, message_id=123
üì¢ [SSE Manager] –ü–æ–ª—É—á–µ–Ω–æ Redis Pub/Sub —Å–æ–±—ã—Ç–∏–µ –¥–ª—è dialog 1
üì§ [SSE Manager] –û—Ç–ø—Ä–∞–≤–ª—è–µ–º 1 –∫–ª–∏–µ–Ω—Ç–∞–º –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ 1

‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
üöÄ [WIDGET‚ÜíADMIN] –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç user –≤ –¥–∏–∞–ª–æ–≥–µ 1
‚ùå [WIDGET‚ÜíADMIN] –û—à–∏–±–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ Redis –¥–ª—è dialog 1: ...
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ Redis Pub/Sub:
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Redis –∏ —Å–ª—É—à–∞—Ç—å —Å–æ–±—ã—Ç–∏—è
redis-cli PSUBSCRIBE "ws:dialog:*"

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –≤–∏–¥–∂–µ—Ç–∞ - –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–±—ã—Ç–∏–µ:
pmessage ws:dialog:* ws:dialog:1 {"type":"message:new","message":{...}}
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

#### –°–∏–º–ø—Ç–æ–º: –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ—è–≤–ª—è—é—Ç—Å—è –∏ –∏—Å—á–µ–∑–∞—é—Ç
```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
üîÑ [DialogModal] –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π: 10  // ‚Üê –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π
üîÑ [DialogModal] –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ API: 1  // ‚Üê –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
```

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏:
```javascript
// –§–∞–π–ª: frontend/components/dialogs/DialogModal.js
// loadMessages –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å forceReplace=true —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
loadMessages(true);  // –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –¥–∏–∞–ª–æ–≥–∞
loadMessages(false); // –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
```

---

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 1. –ü—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ SSE
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ SSE –ø–æ—Ç–æ–∫—É –Ω–∞–ø—Ä—è–º—É—é
curl -N "http://localhost:8000/api/dialogs/1/events?token=JWT_TOKEN"

# –î–ª—è –≤–∏–¥–∂–µ—Ç–∞ –≤ –≥–æ—Å—Ç–µ–≤–æ–º —Ä–µ–∂–∏–º–µ
curl -N "http://localhost:8000/api/dialogs/1/events?assistant_id=3&guest_id=test-guid"

# –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å—Ç—Ä–æ–∫–∏:
retry: 5000
: heartbeat
```

### 2. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
```bash
# –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API
curl -X POST "http://localhost:8000/api/widget/dialogs/1/messages?assistant_id=3&guest_id=test" \
     -H "Content-Type: application/json" \
     -d '{"sender": "user", "text": "–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"}'

# –í SSE –ø–æ—Ç–æ–∫–µ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
event: message
data: {"type":"message:new","message":{"id":123,"sender":"user","text":"–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",...}}
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è SSE —Å–µ—Ä–≤–∏—Å–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl "http://localhost:8000/api/sse/health"
# –û—Ç–≤–µ—Ç: {"status": "healthy", "connections": 0, "redis": "connected"}

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ SSE
curl "http://localhost:8000/api/sse/stats" 
# –û—Ç–≤–µ—Ç: {"active_connections": 2, "events_sent": 15, "connection_details": {...}}
```

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```bash
# –õ–æ–≥–∏ SSE Manager
docker logs replyx-backend -f | grep -E "(SSE Manager|üì¢|üì§|‚úÖ)"

# –õ–æ–≥–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π
docker logs replyx-backend -f | grep -E "(WIDGET‚ÜíADMIN|publish_dialog_event)"

# –í—Å–µ –ª–æ–≥–∏ –≤–∏–¥–∂–µ—Ç–∞
docker logs replyx-backend -f | grep "WIDGET"
```

---

## üöÄ –†–µ—à–µ–Ω–∏—è —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection failed with 403"
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ç–æ–∫–µ–Ω–∞
curl -X POST "http://localhost:8000/api/validate-widget-token" \
     -H "Content-Type: application/json" \
     -d '{"token":"YOUR_TOKEN", "domain":"localhost:3000"}'

# –ï—Å–ª–∏ –¥–æ–º–µ–Ω –Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω, —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω:
curl -X POST "http://localhost:8000/api/widgets" \
     -H "Authorization: Bearer ADMIN_JWT" \
     -H "Content-Type: application/json" \
     -d '{"assistant_id": 3}'
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Events not delivered"
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
redis-cli ping
# –û—Ç–≤–µ—Ç: PONG

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis Pub/Sub
redis-cli PSUBSCRIBE "ws:dialog:*"
# –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ - –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–±—ã—Ç–∏–µ

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSE connections
curl "http://localhost:8000/api/sse/stats"
# active_connections –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å > 0
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Widget –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"
```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–∂–µ—Ç–∞:
[ReplyX Widget] –°–µ—Ä–≤–µ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: —Ç–æ–∫–µ–Ω –Ω–µ –∞–∫—Ç—É–∞–ª–µ–Ω - domains changed

// –†–µ—à–µ–Ω–∏–µ - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏:
// –í dev —Ä–µ–∂–∏–º–µ localhost –¥–æ–º–µ–Ω—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π"
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –¥–≤–æ–π–Ω—É—é –ø—É–±–ª–∏–∫–∞—Ü–∏—é:
docker logs replyx-backend | grep -E "(publish_dialog_event)" | head -10

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ —Å–æ–±—ã—Ç–∏–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ:
‚úÖ [WIDGET‚ÜíADMIN] –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –≤ Redis: dialog_id=1, message_id=123
```

---

## üìä –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç

### ‚úÖ Frontend –ø—Ä–æ–≤–µ—Ä–∫–∏
- [ ] SSE URL —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ localhost:8000 (–Ω–µ 3000)
- [ ] EventSource –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ (status 200)
- [ ] –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `{type: "message:new", message: {...}}`
- [ ] loadMessages –∏—Å–ø–æ–ª—å–∑—É–µ—Ç forceReplace –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –µ—Å—Ç—å –ª–æ–≥–∏ "üì® [–ê–î–ú–ò–ù SSE] –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ"

### ‚úÖ Backend –ø—Ä–æ–≤–µ—Ä–∫–∏  
- [ ] SSE endpoints –æ—Ç–≤–µ—á–∞—é—Ç (curl test)
- [ ] Redis Pub/Sub —Ä–∞–±–æ—Ç–∞–µ—Ç (PSUBSCRIBE test)
- [ ] –°–æ–±—ã—Ç–∏—è –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª
- [ ] –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç "‚úÖ [WIDGET‚ÜíADMIN] –°–æ–æ–±—â–µ–Ω–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –≤ Redis"
- [ ] SSE Manager –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ Redis

### ‚úÖ Infrastructure –ø—Ä–æ–≤–µ—Ä–∫–∏
- [ ] Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è SSE (proxy_buffering off)
- [ ] Redis –¥–æ—Å—Ç—É–ø–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ù–µ—Ç CORS –æ—à–∏–±–æ–∫ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- [ ] SSL/TLS —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTPS)

---

## üéØ –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
- **SSE –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã–µ:** >0 –ø—Ä–∏ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤–∏–¥–∂–µ—Ç–∞—Ö
- **–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:** <500ms –æ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è
- **–ß–∞—Å—Ç–æ—Ç–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:** <1% –æ—Ç –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- **–û—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:** <1% –æ—Ç –æ–±—â–∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

### –ê–ª–µ—Ä—Ç—ã
- SSE connections = 0 –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
- Redis Pub/Sub –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ SSE >2 —Å–µ–∫—É–Ω–¥
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ 5xx >10% –∑–∞ 5 –º–∏–Ω—É—Ç

---

**–°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞:** ‚úÖ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 6 —Å–µ–Ω—Ç—è–±—Ä—è 2025  
**–ü—Ä–∏–º–µ–Ω–∏–º–æ –∫:** ReplyX Widget v1 —Å SSE –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

> üí° **–°–æ–≤–µ—Ç:** –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –Ω–∞—á–∏–Ω–∞–π—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å –ø—Ä–æ–≤–µ—Ä–∫–∏ URL SSE –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ Network tab –±—Ä–∞—É–∑–µ—Ä–∞. 90% –ø—Ä–æ–±–ª–µ–º —Å–≤—è–∑–∞–Ω—ã —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º routing.
