# Страница баланса - Документация

## Обзор

Страница баланса (`/balance`) предоставляет пользователям полный контроль над финансовыми операциями в платформе ReplyX. Страница выполнена в едином стиле дашборда и включает обучающие материалы по работе с балансом.

## Структура страницы

### 1. Welcome Section
- **Заголовок**: "Баланс и оплата"
- **Описание**: "Управление финансами и оплата услуг платформы"
- **Бейдж**: "Безопасные платежи" с иконкой звезды

### 2. Статистика баланса
Отображает ключевые метрики в виде карточек:
- **Текущий баланс**: Сумма средств на счету в рублях
- **Доступные сообщения**: Количество сообщений, доступных для отправки
- **Потрачено за месяц**: Сумма расходов в текущем месяце
- **Статус баланса**: "Активен" или "Нужен пополнение"

### 3. Основной контент
Разделен на две колонки в десктопной версии:

#### 3.1 Быстрые действия (левая колонка)
- **Пополнить баланс**: Кнопка для открытия формы пополнения
- **История платежей**: Переход к странице с историей операций
- **Тарифы и цены**: Информация о стоимости услуг
- **Экономия средств**: Советы по оптимизации расходов

#### 3.2 Форма пополнения / Отображение баланса (правая колонка)
- **По умолчанию**: Полноценный блок с информацией о балансе и быстрым пополнением
- **При активации**: Расширенная форма пополнения с детальными настройками

### 4. Блок пополнения баланса
Широкий интерфейс с распределением элементов на всю доступную ширину:

#### 4.1 Верхняя секция - Статистика в три колонки
- **Текущий баланс**: Градиентный фон, крупная иконка, центрированное расположение
- **Доступные сообщения**: Расчет количества сообщений, синий градиент
- **Стоимость сообщения**: Фиксированная цена 5₽, зеленый градиент
- **Адаптивная сетка**: `grid-cols-1 md:grid-cols-3` для разных экранов

#### 4.2 Быстрые суммы - Две колонки
- **Четыре варианта**: 500₽, 1000₽, 2500₽, 5000₽ в две колонки
- **Цветовые схемы**: Разные градиенты для каждого варианта (синий, зеленый, оранжевый, фиолетовый)
- **Расширенная информация**: Сумма, количество сообщений, иконка кредитной карты
- **Hover эффекты**: Изменение рамки при наведении

#### 4.3 Дополнительная информация - Две колонки
- **Минимальная сумма**: Информация о требованиях пополнения
- **Время зачисления**: Гарантия мгновенного зачисления
- **Серый фон**: `bg-gray-50` для второстепенной информации

#### 4.4 Основная кнопка
- **Полноширинная**: `w-full` для использования всей ширины
- **Улучшенный дизайн**: Иконки с обеих сторон, тень, градиент
- **Призыв к действию**: "Пополнить баланс" с FiArrowRight

#### 4.5 Предупреждения
- **Расширенное уведомление**: Более подробный текст
- **Визуальное выделение**: Красный фон с иконкой
- **Полезная информация**: Указание минимальной суммы

### 5. Обучающие материалы
Развернутая секция с двумя категориями обучения:

#### 5.1 Тарифы и цены (Основы, 5 мин)
- **Стоимость сообщений**: Информация о цене за сообщение
- **Минимальное пополнение**: Минимальная сумма для пополнения
- **Без абонентской платы**: Оплата только за использованные сообщения

#### 5.2 Советы по экономии (Практика, 8 мин)
- **Эффективные промпты**: Как писать эффективные запросы
- **Повторное использование**: Сохранение и повторное использование ответов
- **Оптимизация диалогов**: Эффективное ведение разговоров

### 6. Footer
Информационные блоки с гарантиями:
- Защищенные платежи
- Мгновенное зачисление
- Без скрытых комиссий

## Техническая реализация

### Используемые компоненты
- **React hooks**: useState, useEffect для управления состоянием
- **React Icons**: FiDollarSign, FiCreditCard, FiTrendingUp и другие
- **Dashboard styles**: Переиспользование стилей дашборда
- **LoadingButton**: Кастомный компонент для кнопок с загрузкой

### Функциональность
- **Управление формой**: Показ/скрытие формы пополнения баланса
- **Развертывание секций**: Аккордеон для учебных материалов
- **Обновление баланса**: Синхронизация с другими компонентами через CustomEvent
- **Валидация**: Проверка минимальной суммы пополнения
- **Быстрые суммы**: Предустановленные суммы с автоматическим расчетом сообщений
- **Прогресс-бар**: Визуализация доступных сообщений
- **Рекомендации**: Умные подсказки при низком балансе

### Состояние компонента
```javascript
const [amount, setAmount] = useState('500');           // Сумма пополнения
const [loading, setLoading] = useState(false);         // Состояние загрузки
const [message, setMessage] = useState('');           // Сообщения об ошибках/успехе
const [messageType, setMessageType] = useState('');   // Тип сообщения
const [userBalance, setUserBalance] = useState(0);    // Текущий баланс
const [expandedSection, setExpandedSection] = useState(null); // Развернутая секция
const [showTopupForm, setShowTopupForm] = useState(false);    // Показ формы
```

### API интеграция
- **GET /api/balance/current**: Получение текущего баланса
- **POST /api/balance/topup**: Пополнение баланса
- **CustomEvent**: Синхронизация баланса между компонентами

## Стилистика

### Цветовая схема
- **Фиолетовый акцент**: #7C3AED для основных элементов
- **Серый фон**: #f9fafb для второстепенных элементов
- **Зеленый**: Для успешных операций и положительных индикаторов
- **Красный**: Для ошибок и предупреждений

### Адаптивность
- **Мобильные устройства**: Стек карточек в одну колонку
- **Планшет**: 2 колонки для метрик, адаптивные формы
- **Десктоп**: 3 колонки для основного контента, 4 колонки для метрик

### Анимации
- **Плавные переходы**: 150ms ease для всех интерактивных элементов
- **Fade-in эффект**: При появлении страницы
- **Hover эффекты**: Изменение фона и границ при наведении

## Форма пополнения баланса

### Быстрые суммы
Предустановленные суммы для быстрого выбора:
- 500₽
- 1000₽
- 2500₽
- 5000₽

### Ручной ввод
- **Минимальная сумма**: 500 рублей
- **Валидация**: Проверка корректности введенной суммы
- **Расчет сообщений**: Автоматический расчет количества доступных сообщений

### Процесс оплаты
1. Выбор или ввод суммы
2. Валидация данных
3. Отправка запроса на сервер
4. Обработка ответа
5. Обновление баланса
6. Уведомление пользователя

## Обучающие материалы

### Структура контента
Каждая секция содержит:
- **Заголовок**: Название темы
- **Описание**: Краткое описание содержания
- **Уровень сложности**: Основы/Практика/Эксперт
- **Время изучения**: Ориентировочное время
- **Список статей**: Детальные материалы по теме

### Навигация
- **Внутренние ссылки**: Переходы к другим разделам платформы
- **Внешние ссылки**: Дополнительные ресурсы и документация
- **Развертывание**: Аккордеон для удобного просмотра

## Метрики и аналитика

### Отслеживаемые события
- Просмотр страницы баланса
- Попытки пополнения баланса
- Успешные пополнения
- Просмотр учебных материалов
- Переходы по ссылкам

### Производительность
- **Время загрузки**: Оптимизированная загрузка данных
- **Размер бандла**: Минимизированные импорты иконок
- **Кеширование**: Локальное хранение данных баланса

## Доступность

### Клавиатурная навигация
- **Tab**: Перемещение между интерактивными элементами
- **Enter/Space**: Активация кнопок и ссылок
- **Escape**: Закрытие форм и модальных окон

### Screen readers
- **ARIA-атрибуты**: Правильная семантическая разметка
- **Alt-тексты**: Описания для изображений и иконок
- **Live regions**: Уведомления об изменениях состояния

## Безопасность

### Защита данных
- **HTTPS**: Шифрование всех запросов
- **Токены**: Аутентификация через JWT
- **Валидация**: Проверка всех входных данных

### Финансовая безопасность
- **Шифрование**: Защита платежных данных
- **Валидация сумм**: Предотвращение некорректных операций
- **Логирование**: Отслеживание всех финансовых операций

## Будущие улучшения

### Планируемые функции
- Интеграция с популярными платежными системами
- Автоматическое пополнение при низком балансе
- Детальная аналитика расходов
- Промокоды и скидки
- Многоуровневая система лояльности

### Технические улучшения
- Lazy loading для тяжелых компонентов
- Service Worker для оффлайн-функциональности
- WebSocket для realtime обновлений баланса
- Progressive Web App возможности
