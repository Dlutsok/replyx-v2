.modalOverlay {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  background: rgba(0, 0, 0, 0.6) !important;
  backdrop-filter: blur(4px) !important;
  -webkit-backdrop-filter: blur(4px) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 20px !important;
  z-index: 999999 !important;
  overflow-y: auto !important;
  isolation: isolate !important;
}

.dialogModal {
  width: 70vw;
  max-width: 1280px;
  height: 85vh;
  max-height: 880px;
  background: white;
  border-radius: 12px; /* rounded-xl */
  border: 1px solid #e5e7eb; /* border-gray-200 */
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  display: flex;
  flex-direction: column;
  overflow: visible; /* позволяет вынести кнопку закрытия за пределы модала */
  position: relative;
}

/* Внутренний контейнер, повторяющий скругление, чтобы не было "острых" углов
   у вложенных секций при прокрутке */
.dialogContent {
  height: 100%;
  display: flex;
  flex-direction: column;
  border-radius: 12px;
  overflow: hidden; /* обрезаем внутренние прямые углы */
}

.floatingClose {
  position: absolute;
  top: -14px;
  right: -14px;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: 1px solid #d1d5db;
  background: #ffffff;
  color: #6b7280;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  font-size: 16px;
  font-weight: 400;
  z-index: 3;
  transition: all 200ms ease;
}

.floatingClose:hover {
  background: #f3f4f6;
  border-color: #9ca3af;
  color: #374151;
  transform: rotate(90deg);
}

.floatingClose:active {
  transform: rotate(90deg) scale(0.9);
}

.floatingClose:focus-visible {
  outline: none;
  border-color: #7c3aed;
  box-shadow: 0 0 0 2px rgba(124, 58, 237, 0.2);
}

/* Двухколоночный макет */
.modalBody {
  display: grid;
  grid-template-columns: 1fr 360px;
  height: 100%;
  min-height: 0; /* важно для независимой прокрутки колонок в grid */
}

.chatPane {
  display: flex;
  flex-direction: column;
  border-right: 1px solid #eef0f2;
  min-height: 0; /* разрешаем дочерним overflow работать */
}

.chatScroll {
  flex: 1;
  overflow: auto;
  background: #ffffff;
}

.chatFooter {
  border-top: 1px solid #eef0f2;
  position: sticky;
  bottom: 0;
  z-index: 1;
  background: #fff;
}

.infoPane {
  background: #f9fafb;
  padding: 12px 12px 16px 12px;
  overflow-y: auto; /* независимая прокрутка правой колонки */
  min-height: 0;
  border-top-right-radius: 1.5rem; /* обратное скругление в верхнем правом углу */
  border-bottom-right-radius: 1.5rem; /* обратное скругление в нижнем правом углу */
}

.infoSection { margin-bottom: 12px; }
.infoHeader {
  font-weight: 700;
  font-size: 15px;
  color: #0f172a;
  margin: 8px 4px 8px 4px;
}

.clientCard, .infoCard {
  background: #fff;
  border: 1px solid #e6e8ea;
  border-radius: 12px;
  padding: 12px;
}

.clientRow { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
.avatarCircle { width: 36px; height: 36px; border-radius: 50%; background: #f3e8ff; display:flex; align-items:center; justify-content:center; color:#7c3aed; font-weight:700; }
.clientName { font-weight: 700; font-size: 15px; color:#111827; }
.clientTag { font-size: 13px; font-weight: 600; color:#7c3aed; background:#f3e8ff; border:1px solid #e9d5ff; padding:2px 8px; border-radius:999px; display:inline-block; margin-top:2px; }
.clientDesc { font-size: 13px; color:#6b7280; margin:6px 0 8px 0; }
.inlineActions { display:flex; gap:8px; }
.ghostButton { border:1px solid #e6e8ea; background:#fff; color:#374151; padding:6px 10px; border-radius:10px; font-size:13px; cursor:pointer; }
.ghostButton:hover { background:#f9fafb; }

.metaItem { display:flex; justify-content:space-between; gap:8px; padding:6px 0; }
.metaLabel { color:#6b7280; font-size:13px; font-weight: 600; }
.metaValue { color:#111827; font-size:14px; font-weight:600; }
.metaMuted { color:#9ca3af; font-size:13px; }
.linkButton { background:none; border:none; color:#7c3aed; font-size:13px; padding:4px 0; cursor:pointer; }
.linkButton:hover { text-decoration: underline; }

.loadingContainer {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 16px;
  color: #6b7280;
  padding: 40px;
}

.spinner {
  font-size: 32px;
  color: #7c3aed;
}

.errorModal {
  background: white;
  border-radius: 0.75rem;
  padding: 32px;
  text-align: center;
  max-width: 400px;
  box-shadow: 0 20px 25px rgba(0, 0, 0, 0.1);
}

.errorModal h3 {
  color: #dc2626;
  margin: 0 0 16px 0;
  font-size: 20px;
}

.errorModal p {
  color: #6b7280;
  margin: 0 0 24px 0;
  line-height: 1.6;
}

.errorButton {
  background: #7c3aed;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s ease;
}

.errorButton:hover {
  background: #6d28d9;
}

.errorNotification {
  position: absolute;
  bottom: 20px;
  left: 20px;
  right: 20px;
  background: #dc2626;
  color: white;
  padding: 12px 16px;
  border-radius: 0.75rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 14px;
  z-index: 10;
}

.errorNotification button {
  background: none;
  border: none;
  color: white;
  cursor: pointer;
  font-size: 16px;
  padding: 0;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background 0.2s ease;
}

.errorNotification button:hover {
  background: rgba(255, 255, 255, 0.2);
}

/* Responsive design */
@media (max-width: 768px) {
  .modalOverlay {
    padding: 8px;
    align-items: flex-start;
    padding-top: 20px;
  }
  
  .dialogModal {
    height: calc(100vh - 40px);
    max-height: none;
    border-radius: 0.75rem;
    margin: 0;
  }
  
  .modalBody { grid-template-columns: 1fr; }
  .chatPane { border-right: none; }
  .infoPane { display: none; }
  .dialogHeader { padding: 16px; flex-shrink: 0; }
  
  .dialogTitle {
    font-size: 18px;
  }
  
  .closeButton {
    min-width: 44px;
    min-height: 44px;
  }
  
  .messagesContainer {
    flex: 1;
    overflow-y: auto;
    padding: 0 12px;
  }
  
  .messageInput {
    padding: 16px;
    border-top: 1px solid #e5e7eb;
  }
  
  .inputField {
    font-size: 16px; /* Предотвращает зум на iOS */
    padding: 12px 16px;
  }
  
  .sendButton {
    min-width: 44px;
    min-height: 44px;
    padding: 0;
  }
}

@media (max-width: 480px) {
  .modalOverlay {
    padding: 0;
  }
  
  .dialogModal {
    height: 100vh;
    border-radius: 0;
    max-width: 100vw;
    width: 100vw;
  }
  
  .dialogHeader {
    padding: 12px;
  }
  
  .dialogTitle {
    font-size: 16px;
  }
  
  .messagesContainer {
    padding: 0 8px;
  }
  
  .messageInput {
    padding: 12px;
  }
  
  .errorModal {
    padding: 24px;
  }
  
  .errorNotification {
    left: 12px;
    right: 12px;
    bottom: 12px;
  }
}

/* Анимация появления */
@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

@keyframes overlayFadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Анимации для модального окна */
.modalOverlay {
  animation: overlayFadeIn 300ms ease-out !important;
}

.dialogModal {
  animation: modalSlideIn 400ms cubic-bezier(0.34, 1.56, 0.64, 1) !important;
  transform-origin: center !important;
}

/* Глобальный контейнер как у дашборда */
.mainContainer {
  flex: 1;
  width: 100%;
  margin-left: 64px;
  margin-top: 39px;
  padding: 20px;
  transition: margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  position: relative;
}

.sidebarCollapsed {
  margin-left: 84px;
}

/* Анимация спиннера */
.spinner {
  animation: spin 1s linear infinite !important;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* Стили для индикатора подключения WebSocket */
.connectionStatus {
  display: flex;
  align-items: center;
  padding: 8px 16px;
  background: #f8f9fa;
  border-bottom: 1px solid #e5e7eb;
  font-size: 13px;
  color: #374151;
  min-height: 32px;
}

.statusDot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 8px;
  transition: background-color 0.3s ease;
}

.statusDot.connected {
  background-color: #10b981;
}

.statusDot.disconnected {
  background-color: #ef4444;
}

.statusDot.fallback {
  background-color: #f59e0b;
}

.statusText {
  font-weight: 400;
}