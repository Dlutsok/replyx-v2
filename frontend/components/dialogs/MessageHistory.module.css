.messageHistory {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: #ffffff;
}

.messagesContainer {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Новая строка сообщения как в примере: аватар + тело */
.messageRow { display: grid; grid-template-columns: 36px 1fr; align-items: start; gap: 10px; }
.messageRow.user { grid-template-columns: 1fr 36px; }

.avatar { width: 36px; height: 36px; border-radius: 50%; background: #f3e8ff; color:#7c3aed; display:flex; align-items:center; justify-content:center; font-weight:700; }
.msgBody { background:#fff; border:1px solid #e6e8ea; border-radius: 12px; padding: 10px 12px; box-shadow: 0 1px 2px rgba(17,24,39,0.06); max-width: 75%; width: fit-content; }
.msgHeader { display:flex; align-items:center; gap:8px; margin-bottom:4px; }
.senderName { font-weight:600; color:#374151; font-size:14px; }
.msgTime { color:#9ca3af; font-size:13px; font-weight:500; }
.msgText { color:#374151; font-size:15px; font-weight:400; line-height:1.6; white-space:pre-wrap; }

.messageRow.assistant .msgBody { background:#f9fafb; border-color:#e5e7eb; }
.messageRow.manager .msgBody { background:#7c3aed; border-color:#7c3aed; }
.messageRow.manager .senderName, .messageRow.manager .msgText, .messageRow.manager .msgTime { color:#fff; }

/* Выравнивание справа для пользователя: аватар справа, баббл перед ним */
.messageRow.user .avatar { order: 2; justify-self: end; }
.messageRow.user .msgBody { order: 1; justify-self: end; margin-left: auto; }

.messageWrapper {
  display: flex;
  flex-direction: column;
  max-width: 72%;
}

.messageWrapper.user {
  align-self: flex-end;
  align-items: flex-end;
}

.messageWrapper.assistant,
.messageWrapper.manager {
  align-self: flex-start;
  align-items: flex-start;
}

.senderLabel {
  font-size: 13px;
  font-weight: 600;
  color: #6b7280;
  margin-bottom: 4px;
  padding-left: 12px;
}

.messageBubble {
  background: #ffffff;
  border-radius: 12px;
  padding: 12px 16px;
  box-shadow: 0 1px 2px rgba(17, 24, 39, 0.06);
  border: 1px solid #e6e8ea;
  position: relative;
  max-width: 100%;
  word-wrap: break-word;
}

.messageWrapper.user .messageBubble {
  background: #ffffff;
  color: #111827;
  border-color: #e6e8ea;
}

.messageWrapper.assistant .messageBubble {
  background: #f6f7f9;
  border-color: #e6e8ea;
}

.messageWrapper.manager .messageBubble {
  background: #7c3aed;
  border-color: #7c3aed;
  color: #ffffff;
}

.messageText {
  font-size: 15px;
  font-weight: 400;
  line-height: 1.6;
  white-space: pre-wrap;
  margin-bottom: 4px;
}

.messageWrapper.manager .messageText { color: #ffffff; }

.messageTime {
  font-size: 12px;
  font-weight: 400;
  opacity: 0.6;
  text-align: right;
  margin-top: 4px;
}

.messageWrapper.manager .messageTime { color: rgba(255, 255, 255, 0.9); }

.messageWrapper.assistant .messageTime,
.messageWrapper.user .messageTime {
  color: #9ca3af;
}

/* System messages */
.messageWrapper.system { align-items: center; max-width: 100%; }
.messageWrapper.system .messageBubble {
  background: #fbfbfd;
  border-style: dashed;
  border-color: #e5e7eb;
  color: #6b7280;
}

/* Системные сообщения в общей сетке (как уведомления по центру) */
.messageRow.system { grid-template-columns: 1fr; }
.messageRow.system .msgBody { display:none; }
.messageRow.system .avatar { display:none; }
.messageRow.system .messageWrapper { width: 100%; display:flex; justify-content: center; }

/* Профессиональные уведомления */
.systemNotice { display:flex; align-items:flex-start; gap:10px; margin: 8px auto; padding: 10px 12px; border-radius: 12px; border:1px solid; max-width: 80%; box-shadow: 0 1px 2px rgba(17,24,39,0.06); }
.systemIcon { width:18px; height:18px; margin-top:2px; }
.systemContent { display:flex; flex-direction:column; gap:4px; }
.systemText { font-size:15px; font-weight:400; line-height:1.6; }
.systemTime { font-size:13px; font-weight:500; color:#6b7280; }
.systemNotice.info { background:#f3e8ff; border-color:#e9d5ff; color:#6b21a8; }
.systemNotice.success { background:#ecfdf5; border-color:#a7f3d0; color:#065f46; }
.systemNotice.warning { background:#fffbeb; border-color:#fde68a; color:#92400e; }
.systemNotice.error { background:#fef2f2; border-color:#fecaca; color:#7f1d1d; }

.loadingState,
.errorState,
.emptyState {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  color: #6b7280;
  text-align: center;
}

.loadingState svg {
  width: 24px;
  height: 24px;
  margin-bottom: 12px;
}

.errorState {
  color: #dc2626;
}

.emptyState p {
  font-size: 15px;
  margin: 0;
}

/* Scrollbar styling */
.messagesContainer::-webkit-scrollbar {
  width: 6px;
}

.messagesContainer::-webkit-scrollbar-track {
  background: transparent;
}

.messagesContainer::-webkit-scrollbar-thumb {
  background: #d1d5db;
  border-radius: 0.75rem;
}

.messagesContainer::-webkit-scrollbar-thumb:hover {
  background: #9ca3af;
}