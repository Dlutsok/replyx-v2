#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
–°–æ–∑–¥–∞–µ—Ç 1000 —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
"""

import os
import sys
import random
from datetime import datetime, timedelta
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from database.models import User, Dialog, DialogMessage, Assistant
import uuid

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
DATABASE_URL = os.getenv('DATABASE_URL', 'postgresql://chatai_user:secure_password_2024@localhost:5432/chatai_db')
engine = create_engine(DATABASE_URL)
Session = sessionmaker(bind=engine)

def generate_guest_id():
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π guest_id"""
    return str(uuid.uuid4())

def generate_telegram_data():
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Telegram"""
    usernames = ['alexkrutoy', 'mariapetrova', 'ivan_dev', 'anna_designer', 'max_marketing', 
                'elena_sales', 'dmitry_coder', 'olga_manager', 'pavel_analyst', 'svetlana_hr']
    chat_ids = [random.randint(100000000, 999999999) for _ in range(10)]
    return random.choice(usernames), random.choice(chat_ids)

# –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Ç–µ–º–∞—Ç–∏–∫–∏ –¥–∏–∞–ª–æ–≥–æ–≤
DIALOG_THEMES = [
    {
        'theme': '—Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞',
        'user_messages': [
            '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —É –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –≤—Ö–æ–¥–æ–º –≤ —Å–∏—Å—Ç–µ–º—É',
            '–ù–µ –º–æ–≥—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å',
            '–°–∏—Å—Ç–µ–º–∞ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É 500',
            '–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö?',
            '–ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π?',
            '–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤'
        ],
        'assistant_messages': [
            '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –ø–æ–º–æ–≥—É —Ä–µ—à–∏—Ç—å –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É. –û–ø–∏—à–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.',
            '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É.',
            '–≠—Ç–∞ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ —Å–µ—Ä–≤–µ—Ä–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç.',
            '–ö–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" -> "–î–∞–Ω–Ω—ã–µ".',
            '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.',
            '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä 10MB.'
        ]
    },
    {
        'theme': '–ø—Ä–æ–¥–∞–∂–∏',
        'user_messages': [
            '–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–∏—Ö —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–∞—Ö',
            '–ö–∞–∫–∏–µ –µ—Å—Ç—å —Å–∫–∏–¥–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤?',
            '–ú–æ–∂–Ω–æ –ª–∏ –ø–æ–ª—É—á–∏—Ç—å –¥–µ–º–æ-–≤–µ—Ä—Å–∏—é?',
            '–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è?',
            '–ï—Å—Ç—å –ª–∏ –ø—Ä–æ–±–Ω—ã–π period?',
            '–ö–∞–∫–∏–µ —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã?'
        ],
        'assistant_messages': [
            '–£ –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–∞: –ë–∞–∑–æ–≤—ã–π (900‚ÇΩ/–º–µ—Å), –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π (1900‚ÇΩ/–º–µ—Å) –∏ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ).',
            '–ù–æ–≤—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–∫–∏–¥–∫—É 30% –Ω–∞ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü!',
            '–ö–æ–Ω–µ—á–Ω–æ! –î–µ–º–æ-–≤–µ—Ä—Å–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ 14 –¥–Ω–µ–π –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.',
            '–°—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –ª–∏—Ü–µ–Ω–∑–∏–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.',
            '–î–∞, –≤—Å–µ –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç 14-–¥–Ω–µ–≤–Ω—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥.',
            '–ü—Ä–∏–Ω–∏–º–∞–µ–º –∫–∞—Ä—Ç—ã, —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –∫–æ—à–µ–ª—å–∫–∏, –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã –∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã.'
        ]
    },
    {
        'theme': '–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏',
        'user_messages': [
            '–ö–∞–∫ –ª—É—á—à–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é?',
            '–ö–∞–∫–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç–µ?',
            '–ú–æ–∂–µ—Ç–µ –ø–æ–º–æ—á—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π API?',
            '–ö–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å?',
            '–ö–∞–∫–∏–µ –µ—Å—Ç—å best practices?',
            '–ü–æ–º–æ–≥–∏—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–ª–∞–Ω'
        ],
        'assistant_messages': [
            '–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –∞–≤—Ç–æ–ø—Ä–∞–≤–∏–ª–∞, –∞ –∑–∞—Ç–µ–º –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏.',
            '–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: Slack, Telegram, CRM —Å–∏—Å—Ç–µ–º—ã. –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?',
            '–ö–æ–Ω–µ—á–Ω–æ! –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ —Å—Å—ã–ª–∫–µ. –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏?',
            '–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã: –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CDN.',
            '–ì–ª–∞–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞: —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π.',
            '–ß—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –ø–ª–∞–Ω, —Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–ª—é—á–µ–≤—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö.'
        ]
    },
    {
        'theme': '–∂–∞–ª–æ–±—ã',
        'user_messages': [
            '–û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞',
            '–ü–æ—Å—Ç–æ—è–Ω–Ω–æ –≤—ã–ª–µ—Ç–∞—é—Ç –æ—à–∏–±–∫–∏',
            '–ù–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–¥–¥–µ—Ä–∂–∫–∏',
            '–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–∞—è–≤–ª–µ–Ω–Ω–æ–º—É',
            '–•–æ—á—É –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É',
            '–¢—Ä–µ–±—É—é –≤–æ–∑–≤—Ä–∞—Ç –¥–µ–Ω–µ–≥'
        ],
        'assistant_messages': [
            '–ò–∑–≤–∏–Ω–∏—Ç–µ –∑–∞ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞. –ü–µ—Ä–µ–¥–∞–º –≤–∞—à—É –∂–∞–ª–æ–±—É —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –æ—Ç–¥–µ–ª—É –¥–ª—è —Å—Ä–æ—á–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è.',
            '–ü–æ–Ω–∏–º–∞—é –≤–∞—à–µ —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ. –ö–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –æ—à–∏–±–∫–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç? –û—Ç–ø—Ä–∞–≤–ª—é –æ—Ç—á–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º.',
            '–ü—Ä–∏–Ω–æ—à—É –∏–∑–≤–∏–Ω–µ–Ω–∏—è –∑–∞ –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å. –ü–æ–¥–∫–ª—é—á—É —Å—Ç–∞—Ä—à–µ–≥–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.',
            '–î–µ—Ç–∞–ª—å–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º –≤–∞—à–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –Ω–∞–π–¥–µ–º —Ä–µ—à–µ–Ω–∏–µ. –ú–æ–∂–µ—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã?',
            '–û–±—Ä–∞–±–æ—Ç–∞—é –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ—Ç–º–µ–Ω—É. –ú–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞?',
            '–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞. –ü–µ—Ä–µ–¥–∞–º –∑–∞—è–≤–∫—É –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç–¥–µ–ª.'
        ]
    },
    {
        'theme': '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è',
        'user_messages': [
            '–ö–∞–∫–∏–µ –Ω–æ–≤–∏–Ω–∫–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –≤ —Å–∏—Å—Ç–µ–º–µ?',
            '–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö',
            '–ö–æ–≥–¥–∞ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –≤—ã–ø—É—Å–∫ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏?',
            '–ö–∞–∫–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–∞—à –ø—Ä–æ–¥—É–∫—Ç?',
            '–ï—Å—Ç—å –ª–∏ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?',
            '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ª–∏ –¥—Ä—É–≥–∏–µ —è–∑—ã–∫–∏?'
        ],
        'assistant_messages': [
            '–í –ø–æ—Å–ª–µ–¥–Ω–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–æ–±–∞–≤–∏–ª–∏: –¥–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã, —ç–∫—Å–ø–æ—Ä—Ç –≤ Excel.',
            '–í–µ—Ä—Å–∏—è 2.1 –≤–∫–ª—é—á–∞–µ—Ç –Ω–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä, —Ç–µ–º–Ω—É—é —Ç–µ–º—É –∏ —É–ª—É—á—à–µ–Ω–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.',
            '–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –∫–æ–Ω–µ—Ü –∫–≤–∞—Ä—Ç–∞–ª–∞. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –Ω–æ–≤–æ—Å—Ç—è–º–∏!',
            '–ù–∞—à–∏–º–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏ —è–≤–ª—è—é—Ç—Å—è –°–±–µ—Ä, –Ø–Ω–¥–µ–∫—Å, –ú–¢–° –∏ –±–æ–ª–µ–µ 1000 –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π.',
            '–î–∞, –º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã –≤ App Store –∏ Google Play.',
            '–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –Ω–∞ —Ä—É—Å—Å–∫–∏–π, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π, –Ω–µ–º–µ—Ü–∫–∏–π –∏ –∫–∏—Ç–∞–π—Å–∫–∏–π —è–∑—ã–∫–∏.'
        ]
    }
]

# –°—Ç–∞—Ç—É—Å—ã –¥–∏–∞–ª–æ–≥–æ–≤
DIALOG_STATUSES = ['active', 'ended', 'transferred']
HANDOFF_STATUSES = ['none', 'requested', 'active', 'released']

def create_test_dialogs(count=1000):
    """–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏"""
    db = Session()
    
    try:
        # –ü–æ–ª—É—á–∞–µ–º admin –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        admin_user = db.query(User).filter(User.email == 'admin@example.com').first()
        if not admin_user:
            print("‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å admin@example.com –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            return
            
        # –ü–æ–ª—É—á–∞–µ–º –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤
        assistants = db.query(Assistant).filter(Assistant.user_id == admin_user.id).all()
        if not assistants:
            print("‚ùå –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
            return
            
        print(f"üîÑ –°–æ–∑–¥–∞–Ω–∏–µ {count} —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤...")
        
        created_dialogs = 0
        
        for i in range(count):
            try:
                # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Ç–µ–º–∞—Ç–∏–∫—É
                theme_data = random.choice(DIALOG_THEMES)
                
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∏–∞–ª–æ–≥–∞
                guest_id = generate_guest_id()
                started_at = datetime.utcnow() - timedelta(
                    days=random.randint(1, 90),
                    hours=random.randint(0, 23),
                    minutes=random.randint(0, 59)
                )
                
                # –°–ª—É—á–∞–π–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã
                is_ended = random.choice([True, False, False, False])  # 25% —à–∞–Ω—Å —á—Ç–æ –¥–∏–∞–ª–æ–≥ –∑–∞–≤–µ—Ä—à–µ–Ω
                ended_at = started_at + timedelta(hours=random.randint(1, 24)) if is_ended else None
                handoff_status = random.choice(HANDOFF_STATUSES)
                
                # Telegram –¥–∞–Ω–Ω—ã–µ (50% —à–∞–Ω—Å)
                telegram_username = None
                telegram_chat_id = None
                if random.choice([True, False]):
                    telegram_username, telegram_chat_id = generate_telegram_data()
                
                # –°–æ–∑–¥–∞–µ–º –¥–∏–∞–ª–æ–≥
                dialog = Dialog(
                    user_id=admin_user.id,
                    guest_id=guest_id,
                    started_at=started_at,
                    ended_at=ended_at,
                    auto_response=random.randint(0, 1),
                    fallback=random.randint(0, 1),
                    is_taken_over=1 if handoff_status in ['requested', 'active'] else 0,
                    handoff_status=handoff_status,
                    telegram_username=telegram_username,
                    telegram_chat_id=telegram_chat_id,
                    first_response_time=random.randint(30, 300) if random.choice([True, False]) else None
                )
                
                db.add(dialog)
                db.flush()  # –ü–æ–ª—É—á–∞–µ–º ID –¥–∏–∞–ª–æ–≥–∞
                
                # –°–æ–∑–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –¥–∏–∞–ª–æ–≥–∞
                message_count = random.randint(1, 15)  # –û—Ç 1 –¥–æ 15 —Å–æ–æ–±—â–µ–Ω–∏–π
                current_time = started_at
                
                for msg_idx in range(message_count):
                    # –ß–µ—Ä–µ–¥—É–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π
                    if msg_idx == 0:
                        sender = 'user'  # –ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        text = random.choice(theme_data['user_messages'])
                    else:
                        sender = 'assistant' if msg_idx % 2 == 1 else 'user'
                        if sender == 'user':
                            text = random.choice(theme_data['user_messages'])
                        else:
                            text = random.choice(theme_data['assistant_messages'])
                    
                    # –ò–Ω–æ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞
                    if handoff_status == 'active' and random.random() < 0.3:
                        sender = 'manager'
                        text = f"–Ø –º–µ–Ω–µ–¥–∂–µ—Ä {random.choice(['–ê–Ω–Ω–∞', '–î–º–∏—Ç—Ä–∏–π', '–ï–ª–µ–Ω–∞', '–ú–∞–∫—Å–∏–º'])}. {text}"
                    
                    current_time += timedelta(minutes=random.randint(1, 30))
                    
                    message = DialogMessage(
                        dialog_id=dialog.id,
                        sender=sender,
                        text=text,
                        timestamp=current_time
                    )
                    db.add(message)
                
                created_dialogs += 1
                
                # –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
                if created_dialogs % 100 == 0:
                    db.commit()
                    print(f"‚úÖ –°–æ–∑–¥–∞–Ω–æ {created_dialogs} –¥–∏–∞–ª–æ–≥–æ–≤...")
                    
            except Exception as e:
                print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞ {i+1}: {e}")
                db.rollback()
                continue
        
        # –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        db.commit()
        print(f"üéâ –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ {created_dialogs} —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤!")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        total_dialogs = db.query(Dialog).filter(Dialog.user_id == admin_user.id).count()
        total_messages = db.query(DialogMessage).join(Dialog).filter(Dialog.user_id == admin_user.id).count()
        
        print(f"üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   - –í—Å–µ–≥–æ –¥–∏–∞–ª–æ–≥–æ–≤: {total_dialogs}")
        print(f"   - –í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π: {total_messages}")
        print(f"   - –ê–∫—Ç–∏–≤–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤: {db.query(Dialog).filter(Dialog.user_id == admin_user.id, Dialog.ended_at.is_(None)).count()}")
        print(f"   - –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤: {db.query(Dialog).filter(Dialog.user_id == admin_user.id, Dialog.ended_at.isnot(None)).count()}")
        print(f"   - –î–∏–∞–ª–æ–≥–æ–≤ —Å handoff: {db.query(Dialog).filter(Dialog.user_id == admin_user.id, Dialog.handoff_status != 'none').count()}")
        print(f"   - Telegram –¥–∏–∞–ª–æ–≥–æ–≤: {db.query(Dialog).filter(Dialog.user_id == admin_user.id, Dialog.telegram_username.isnot(None)).count()}")
        
    except Exception as e:
        print(f"‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        db.rollback()
    finally:
        db.close()

if __name__ == "__main__":
    create_test_dialogs(1000)